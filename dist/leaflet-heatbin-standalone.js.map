{"version":3,"file":"leaflet-heatbin-standalone.js","sources":["../node_modules/heatmap.js/build/heatmap.js","../src/L.HeatBin.js"],"sourcesContent":["/*\n * heatmap.js v2.0.5 | JavaScript Heatmap Library\n *\n * Copyright 2008-2016 Patrick Wied <heatmapjs@patrick-wied.at> - All rights reserved.\n * Dual licensed under MIT and Beerware license \n *\n * :: 2016-09-05 01:16\n */\n;(function (name, context, factory) {\n\n  // Supports UMD. AMD, CommonJS/Node.js and browser context\n  if (typeof module !== \"undefined\" && module.exports) {\n    module.exports = factory();\n  } else if (typeof define === \"function\" && define.amd) {\n    define(factory);\n  } else {\n    context[name] = factory();\n  }\n\n})(\"h337\", this, function () {\n\n// Heatmap Config stores default values and will be merged with instance config\nvar HeatmapConfig = {\n  defaultRadius: 40,\n  defaultRenderer: 'canvas2d',\n  defaultGradient: { 0.25: \"rgb(0,0,255)\", 0.55: \"rgb(0,255,0)\", 0.85: \"yellow\", 1.0: \"rgb(255,0,0)\"},\n  defaultMaxOpacity: 1,\n  defaultMinOpacity: 0,\n  defaultBlur: .85,\n  defaultXField: 'x',\n  defaultYField: 'y',\n  defaultValueField: 'value', \n  plugins: {}\n};\nvar Store = (function StoreClosure() {\n\n  var Store = function Store(config) {\n    this._coordinator = {};\n    this._data = [];\n    this._radi = [];\n    this._min = 10;\n    this._max = 1;\n    this._xField = config['xField'] || config.defaultXField;\n    this._yField = config['yField'] || config.defaultYField;\n    this._valueField = config['valueField'] || config.defaultValueField;\n\n    if (config[\"radius\"]) {\n      this._cfgRadius = config[\"radius\"];\n    }\n  };\n\n  var defaultRadius = HeatmapConfig.defaultRadius;\n\n  Store.prototype = {\n    // when forceRender = false -> called from setData, omits renderall event\n    _organiseData: function(dataPoint, forceRender) {\n        var x = dataPoint[this._xField];\n        var y = dataPoint[this._yField];\n        var radi = this._radi;\n        var store = this._data;\n        var max = this._max;\n        var min = this._min;\n        var value = dataPoint[this._valueField] || 1;\n        var radius = dataPoint.radius || this._cfgRadius || defaultRadius;\n\n        if (!store[x]) {\n          store[x] = [];\n          radi[x] = [];\n        }\n\n        if (!store[x][y]) {\n          store[x][y] = value;\n          radi[x][y] = radius;\n        } else {\n          store[x][y] += value;\n        }\n        var storedVal = store[x][y];\n\n        if (storedVal > max) {\n          if (!forceRender) {\n            this._max = storedVal;\n          } else {\n            this.setDataMax(storedVal);\n          }\n          return false;\n        } else if (storedVal < min) {\n          if (!forceRender) {\n            this._min = storedVal;\n          } else {\n            this.setDataMin(storedVal);\n          }\n          return false;\n        } else {\n          return { \n            x: x, \n            y: y,\n            value: value, \n            radius: radius,\n            min: min,\n            max: max \n          };\n        }\n    },\n    _unOrganizeData: function() {\n      var unorganizedData = [];\n      var data = this._data;\n      var radi = this._radi;\n\n      for (var x in data) {\n        for (var y in data[x]) {\n\n          unorganizedData.push({\n            x: x,\n            y: y,\n            radius: radi[x][y],\n            value: data[x][y]\n          });\n\n        }\n      }\n      return {\n        min: this._min,\n        max: this._max,\n        data: unorganizedData\n      };\n    },\n    _onExtremaChange: function() {\n      this._coordinator.emit('extremachange', {\n        min: this._min,\n        max: this._max\n      });\n    },\n    addData: function() {\n      if (arguments[0].length > 0) {\n        var dataArr = arguments[0];\n        var dataLen = dataArr.length;\n        while (dataLen--) {\n          this.addData.call(this, dataArr[dataLen]);\n        }\n      } else {\n        // add to store  \n        var organisedEntry = this._organiseData(arguments[0], true);\n        if (organisedEntry) {\n          // if it's the first datapoint initialize the extremas with it\n          if (this._data.length === 0) {\n            this._min = this._max = organisedEntry.value;\n          }\n          this._coordinator.emit('renderpartial', {\n            min: this._min,\n            max: this._max,\n            data: [organisedEntry]\n          });\n        }\n      }\n      return this;\n    },\n    setData: function(data) {\n      var dataPoints = data.data;\n      var pointsLen = dataPoints.length;\n\n\n      // reset data arrays\n      this._data = [];\n      this._radi = [];\n\n      for(var i = 0; i < pointsLen; i++) {\n        this._organiseData(dataPoints[i], false);\n      }\n      this._max = data.max;\n      this._min = data.min || 0;\n      \n      this._onExtremaChange();\n      this._coordinator.emit('renderall', this._getInternalData());\n      return this;\n    },\n    removeData: function() {\n      // TODO: implement\n    },\n    setDataMax: function(max) {\n      this._max = max;\n      this._onExtremaChange();\n      this._coordinator.emit('renderall', this._getInternalData());\n      return this;\n    },\n    setDataMin: function(min) {\n      this._min = min;\n      this._onExtremaChange();\n      this._coordinator.emit('renderall', this._getInternalData());\n      return this;\n    },\n    setCoordinator: function(coordinator) {\n      this._coordinator = coordinator;\n    },\n    _getInternalData: function() {\n      return { \n        max: this._max,\n        min: this._min, \n        data: this._data,\n        radi: this._radi \n      };\n    },\n    getData: function() {\n      return this._unOrganizeData();\n    }/*,\n\n      TODO: rethink.\n\n    getValueAt: function(point) {\n      var value;\n      var radius = 100;\n      var x = point.x;\n      var y = point.y;\n      var data = this._data;\n\n      if (data[x] && data[x][y]) {\n        return data[x][y];\n      } else {\n        var values = [];\n        // radial search for datapoints based on default radius\n        for(var distance = 1; distance < radius; distance++) {\n          var neighbors = distance * 2 +1;\n          var startX = x - distance;\n          var startY = y - distance;\n\n          for(var i = 0; i < neighbors; i++) {\n            for (var o = 0; o < neighbors; o++) {\n              if ((i == 0 || i == neighbors-1) || (o == 0 || o == neighbors-1)) {\n                if (data[startY+i] && data[startY+i][startX+o]) {\n                  values.push(data[startY+i][startX+o]);\n                }\n              } else {\n                continue;\n              } \n            }\n          }\n        }\n        if (values.length > 0) {\n          return Math.max.apply(Math, values);\n        }\n      }\n      return false;\n    }*/\n  };\n\n\n  return Store;\n})();\n\nvar Canvas2dRenderer = (function Canvas2dRendererClosure() {\n\n  var _getColorPalette = function(config) {\n    var gradientConfig = config.gradient || config.defaultGradient;\n    var paletteCanvas = document.createElement('canvas');\n    var paletteCtx = paletteCanvas.getContext('2d');\n\n    paletteCanvas.width = 256;\n    paletteCanvas.height = 1;\n\n    var gradient = paletteCtx.createLinearGradient(0, 0, 256, 1);\n    for (var key in gradientConfig) {\n      gradient.addColorStop(key, gradientConfig[key]);\n    }\n\n    paletteCtx.fillStyle = gradient;\n    paletteCtx.fillRect(0, 0, 256, 1);\n\n    return paletteCtx.getImageData(0, 0, 256, 1).data;\n  };\n\n  var _getPointTemplate = function(radius, blurFactor) {\n    var tplCanvas = document.createElement('canvas');\n    var tplCtx = tplCanvas.getContext('2d');\n    var x = radius;\n    var y = radius;\n    tplCanvas.width = tplCanvas.height = radius*2;\n\n    if (blurFactor == 1) {\n      tplCtx.beginPath();\n      tplCtx.arc(x, y, radius, 0, 2 * Math.PI, false);\n      tplCtx.fillStyle = 'rgba(0,0,0,1)';\n      tplCtx.fill();\n    } else {\n      var gradient = tplCtx.createRadialGradient(x, y, radius*blurFactor, x, y, radius);\n      gradient.addColorStop(0, 'rgba(0,0,0,1)');\n      gradient.addColorStop(1, 'rgba(0,0,0,0)');\n      tplCtx.fillStyle = gradient;\n      tplCtx.fillRect(0, 0, 2*radius, 2*radius);\n    }\n\n\n\n    return tplCanvas;\n  };\n\n  var _prepareData = function(data) {\n    var renderData = [];\n    var min = data.min;\n    var max = data.max;\n    var radi = data.radi;\n    var data = data.data;\n\n    var xValues = Object.keys(data);\n    var xValuesLen = xValues.length;\n\n    while(xValuesLen--) {\n      var xValue = xValues[xValuesLen];\n      var yValues = Object.keys(data[xValue]);\n      var yValuesLen = yValues.length;\n      while(yValuesLen--) {\n        var yValue = yValues[yValuesLen];\n        var value = data[xValue][yValue];\n        var radius = radi[xValue][yValue];\n        renderData.push({\n          x: xValue,\n          y: yValue,\n          value: value,\n          radius: radius\n        });\n      }\n    }\n\n    return {\n      min: min,\n      max: max,\n      data: renderData\n    };\n  };\n\n\n  function Canvas2dRenderer(config) {\n    var container = config.container;\n    var shadowCanvas = this.shadowCanvas = document.createElement('canvas');\n    var canvas = this.canvas = config.canvas || document.createElement('canvas');\n    var renderBoundaries = this._renderBoundaries = [10000, 10000, 0, 0];\n\n    var computed = getComputedStyle(config.container) || {};\n\n    canvas.className = 'heatmap-canvas';\n\n    this._width = canvas.width = shadowCanvas.width = config.width || +(computed.width.replace(/px/,''));\n    this._height = canvas.height = shadowCanvas.height = config.height || +(computed.height.replace(/px/,''));\n\n    this.shadowCtx = shadowCanvas.getContext('2d');\n    this.ctx = canvas.getContext('2d');\n\n    // @TODO:\n    // conditional wrapper\n\n    canvas.style.cssText = shadowCanvas.style.cssText = 'position:absolute;left:0;top:0;';\n\n    container.style.position = 'relative';\n    container.appendChild(canvas);\n\n    this._palette = _getColorPalette(config);\n    this._templates = {};\n\n    this._setStyles(config);\n  };\n\n  Canvas2dRenderer.prototype = {\n    renderPartial: function(data) {\n      if (data.data.length > 0) {\n        this._drawAlpha(data);\n        this._colorize();\n      }\n    },\n    renderAll: function(data) {\n      // reset render boundaries\n      this._clear();\n      if (data.data.length > 0) {\n        this._drawAlpha(_prepareData(data));\n        this._colorize();\n      }\n    },\n    _updateGradient: function(config) {\n      this._palette = _getColorPalette(config);\n    },\n    updateConfig: function(config) {\n      if (config['gradient']) {\n        this._updateGradient(config);\n      }\n      this._setStyles(config);\n    },\n    setDimensions: function(width, height) {\n      this._width = width;\n      this._height = height;\n      this.canvas.width = this.shadowCanvas.width = width;\n      this.canvas.height = this.shadowCanvas.height = height;\n    },\n    _clear: function() {\n      this.shadowCtx.clearRect(0, 0, this._width, this._height);\n      this.ctx.clearRect(0, 0, this._width, this._height);\n    },\n    _setStyles: function(config) {\n      this._blur = (config.blur == 0)?0:(config.blur || config.defaultBlur);\n\n      if (config.backgroundColor) {\n        this.canvas.style.backgroundColor = config.backgroundColor;\n      }\n\n      this._width = this.canvas.width = this.shadowCanvas.width = config.width || this._width;\n      this._height = this.canvas.height = this.shadowCanvas.height = config.height || this._height;\n\n\n      this._opacity = (config.opacity || 0) * 255;\n      this._maxOpacity = (config.maxOpacity || config.defaultMaxOpacity) * 255;\n      this._minOpacity = (config.minOpacity || config.defaultMinOpacity) * 255;\n      this._useGradientOpacity = !!config.useGradientOpacity;\n    },\n    _drawAlpha: function(data) {\n      var min = this._min = data.min;\n      var max = this._max = data.max;\n      var data = data.data || [];\n      var dataLen = data.length;\n      // on a point basis?\n      var blur = 1 - this._blur;\n\n      while(dataLen--) {\n\n        var point = data[dataLen];\n\n        var x = point.x;\n        var y = point.y;\n        var radius = point.radius;\n        // if value is bigger than max\n        // use max as value\n        var value = Math.min(point.value, max);\n        var rectX = x - radius;\n        var rectY = y - radius;\n        var shadowCtx = this.shadowCtx;\n\n\n\n\n        var tpl;\n        if (!this._templates[radius]) {\n          this._templates[radius] = tpl = _getPointTemplate(radius, blur);\n        } else {\n          tpl = this._templates[radius];\n        }\n        // value from minimum / value range\n        // => [0, 1]\n        var templateAlpha = (value-min)/(max-min);\n        // this fixes #176: small values are not visible because globalAlpha < .01 cannot be read from imageData\n        shadowCtx.globalAlpha = templateAlpha < .01 ? .01 : templateAlpha;\n\n        shadowCtx.drawImage(tpl, rectX, rectY);\n\n        // update renderBoundaries\n        if (rectX < this._renderBoundaries[0]) {\n            this._renderBoundaries[0] = rectX;\n          }\n          if (rectY < this._renderBoundaries[1]) {\n            this._renderBoundaries[1] = rectY;\n          }\n          if (rectX + 2*radius > this._renderBoundaries[2]) {\n            this._renderBoundaries[2] = rectX + 2*radius;\n          }\n          if (rectY + 2*radius > this._renderBoundaries[3]) {\n            this._renderBoundaries[3] = rectY + 2*radius;\n          }\n\n      }\n    },\n    _colorize: function() {\n      var x = this._renderBoundaries[0];\n      var y = this._renderBoundaries[1];\n      var width = this._renderBoundaries[2] - x;\n      var height = this._renderBoundaries[3] - y;\n      var maxWidth = this._width;\n      var maxHeight = this._height;\n      var opacity = this._opacity;\n      var maxOpacity = this._maxOpacity;\n      var minOpacity = this._minOpacity;\n      var useGradientOpacity = this._useGradientOpacity;\n\n      if (x < 0) {\n        x = 0;\n      }\n      if (y < 0) {\n        y = 0;\n      }\n      if (x + width > maxWidth) {\n        width = maxWidth - x;\n      }\n      if (y + height > maxHeight) {\n        height = maxHeight - y;\n      }\n\n      var img = this.shadowCtx.getImageData(x, y, width, height);\n      var imgData = img.data;\n      var len = imgData.length;\n      var palette = this._palette;\n\n\n      for (var i = 3; i < len; i+= 4) {\n        var alpha = imgData[i];\n        var offset = alpha * 4;\n\n\n        if (!offset) {\n          continue;\n        }\n\n        var finalAlpha;\n        if (opacity > 0) {\n          finalAlpha = opacity;\n        } else {\n          if (alpha < maxOpacity) {\n            if (alpha < minOpacity) {\n              finalAlpha = minOpacity;\n            } else {\n              finalAlpha = alpha;\n            }\n          } else {\n            finalAlpha = maxOpacity;\n          }\n        }\n\n        imgData[i-3] = palette[offset];\n        imgData[i-2] = palette[offset + 1];\n        imgData[i-1] = palette[offset + 2];\n        imgData[i] = useGradientOpacity ? palette[offset + 3] : finalAlpha;\n\n      }\n\n      img.data = imgData;\n      this.ctx.putImageData(img, x, y);\n\n      this._renderBoundaries = [1000, 1000, 0, 0];\n\n    },\n    getValueAt: function(point) {\n      var value;\n      var shadowCtx = this.shadowCtx;\n      var img = shadowCtx.getImageData(point.x, point.y, 1, 1);\n      var data = img.data[3];\n      var max = this._max;\n      var min = this._min;\n\n      value = (Math.abs(max-min) * (data/255)) >> 0;\n\n      return value;\n    },\n    getDataURL: function() {\n      return this.canvas.toDataURL();\n    }\n  };\n\n\n  return Canvas2dRenderer;\n})();\n\n\nvar Renderer = (function RendererClosure() {\n\n  var rendererFn = false;\n\n  if (HeatmapConfig['defaultRenderer'] === 'canvas2d') {\n    rendererFn = Canvas2dRenderer;\n  }\n\n  return rendererFn;\n})();\n\n\nvar Util = {\n  merge: function() {\n    var merged = {};\n    var argsLen = arguments.length;\n    for (var i = 0; i < argsLen; i++) {\n      var obj = arguments[i]\n      for (var key in obj) {\n        merged[key] = obj[key];\n      }\n    }\n    return merged;\n  }\n};\n// Heatmap Constructor\nvar Heatmap = (function HeatmapClosure() {\n\n  var Coordinator = (function CoordinatorClosure() {\n\n    function Coordinator() {\n      this.cStore = {};\n    };\n\n    Coordinator.prototype = {\n      on: function(evtName, callback, scope) {\n        var cStore = this.cStore;\n\n        if (!cStore[evtName]) {\n          cStore[evtName] = [];\n        }\n        cStore[evtName].push((function(data) {\n            return callback.call(scope, data);\n        }));\n      },\n      emit: function(evtName, data) {\n        var cStore = this.cStore;\n        if (cStore[evtName]) {\n          var len = cStore[evtName].length;\n          for (var i=0; i<len; i++) {\n            var callback = cStore[evtName][i];\n            callback(data);\n          }\n        }\n      }\n    };\n\n    return Coordinator;\n  })();\n\n\n  var _connect = function(scope) {\n    var renderer = scope._renderer;\n    var coordinator = scope._coordinator;\n    var store = scope._store;\n\n    coordinator.on('renderpartial', renderer.renderPartial, renderer);\n    coordinator.on('renderall', renderer.renderAll, renderer);\n    coordinator.on('extremachange', function(data) {\n      scope._config.onExtremaChange &&\n      scope._config.onExtremaChange({\n        min: data.min,\n        max: data.max,\n        gradient: scope._config['gradient'] || scope._config['defaultGradient']\n      });\n    });\n    store.setCoordinator(coordinator);\n  };\n\n\n  function Heatmap() {\n    var config = this._config = Util.merge(HeatmapConfig, arguments[0] || {});\n    this._coordinator = new Coordinator();\n    if (config['plugin']) {\n      var pluginToLoad = config['plugin'];\n      if (!HeatmapConfig.plugins[pluginToLoad]) {\n        throw new Error('Plugin \\''+ pluginToLoad + '\\' not found. Maybe it was not registered.');\n      } else {\n        var plugin = HeatmapConfig.plugins[pluginToLoad];\n        // set plugin renderer and store\n        this._renderer = new plugin.renderer(config);\n        this._store = new plugin.store(config);\n      }\n    } else {\n      this._renderer = new Renderer(config);\n      this._store = new Store(config);\n    }\n    _connect(this);\n  };\n\n  // @TODO:\n  // add API documentation\n  Heatmap.prototype = {\n    addData: function() {\n      this._store.addData.apply(this._store, arguments);\n      return this;\n    },\n    removeData: function() {\n      this._store.removeData && this._store.removeData.apply(this._store, arguments);\n      return this;\n    },\n    setData: function() {\n      this._store.setData.apply(this._store, arguments);\n      return this;\n    },\n    setDataMax: function() {\n      this._store.setDataMax.apply(this._store, arguments);\n      return this;\n    },\n    setDataMin: function() {\n      this._store.setDataMin.apply(this._store, arguments);\n      return this;\n    },\n    configure: function(config) {\n      this._config = Util.merge(this._config, config);\n      this._renderer.updateConfig(this._config);\n      this._coordinator.emit('renderall', this._store._getInternalData());\n      return this;\n    },\n    repaint: function() {\n      this._coordinator.emit('renderall', this._store._getInternalData());\n      return this;\n    },\n    getData: function() {\n      return this._store.getData();\n    },\n    getDataURL: function() {\n      return this._renderer.getDataURL();\n    },\n    getValueAt: function(point) {\n\n      if (this._store.getValueAt) {\n        return this._store.getValueAt(point);\n      } else  if (this._renderer.getValueAt) {\n        return this._renderer.getValueAt(point);\n      } else {\n        return null;\n      }\n    }\n  };\n\n  return Heatmap;\n\n})();\n\n\n// core\nvar heatmapFactory = {\n  create: function(config) {\n    return new Heatmap(config);\n  },\n  register: function(pluginKey, plugin) {\n    HeatmapConfig.plugins[pluginKey] = plugin;\n  }\n};\n\nreturn heatmapFactory;\n\n\n});","import h337 from 'heatmap.js';\nimport turf from 'turf';\n\nconst HeatBin = (L.Layer ? L.Layer : L.Class).extend({\n\n\t/*--------------------------------------------- LEAFLET HOOKS ---------------------------------------------*/\n\n\tinitialize: function (config) {\n\t\tthis.cfg = config;\n\t\tthis._el = L.DomUtil.create('div', 'leaflet-zoom-hide');\n\t\tthis._data = [];\n\t\tthis._max = 1;\n\t\tthis._min = 0;\n\t\tthis.cfg.container = this._el;\n\t},\n\n\tonAdd: function (map) {\n\t\tvar size = map.getSize();\n\n\t\tthis._map = map;\n\n\t\tthis._width = size.x;\n\t\tthis._height = size.y;\n\n\t\tthis._el.style.width = size.x + 'px';\n\t\tthis._el.style.height = size.y + 'px';\n\t\tthis._el.style.position = 'absolute';\n\n\t\tthis._origin = this._map.layerPointToLatLng(new L.Point(0, 0));\n\n\t\tmap.getPanes().overlayPane.appendChild(this._el);\n\n\t\tif (!this._heatmap) {\n\t\t\tthis._heatmap = h337.create(this.cfg);\n\t\t}\n\n\t\t// this resets the origin and redraws whenever\n\t\t// the zoom changed or the map has been moved\n\t\tmap.on('moveend', this._reset, this);\n\t\tthis._draw();\n\t},\n\n\taddTo: function (map) {\n\t\tmap.addLayer(this);\n\t\treturn this;\n\t},\n\n\tonRemove: function (map) {\n\t\t// remove layer's DOM elements and listeners\n\t\tmap.getPanes().overlayPane.removeChild(this._el);\n\t\tmap.off('moveend', this._reset, this);\n\t},\n\n\t/*--------------------------------------------- PUBLIC ---------------------------------------------*/\n\n\t/**\n\t * Returns leaflet LatLngBounds of the layer data\n\t */\n\tgetLatLngBounds (data) {\n\t\tdata = data || this._data;\n\t\tif (data.length < 1) return null;\n\t\treturn L.latLngBounds(data.map((d) => {\n\t\t\treturn [d[this._latField], d[this._lngField]];\n\t\t}));\n\t},\n\n\tupdate: function() {\n\n\t\tvar bounds, zoom, scale;\n\t\tvar generatedData = { max: this._max, min: this._min, data: [] };\n\n\t\tbounds = this._map.getBounds();\n\t\tzoom = this._map.getZoom();\n\t\tscale = Math.pow(2, zoom);\n\n\t\tif (this._data.length == 0) {\n\t\t\tif (this._heatmap) {\n\t\t\t\tthis._heatmap.setData(generatedData);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tvar latLngPoints = [];\n\t\tvar radiusMultiplier = this.cfg.scaleRadius ? scale : 1;\n\t\tvar localMax = 0;\n\t\tvar localMin = 0;\n\t\tvar valueField = this.cfg.valueField;\n\t\tvar len = this._data.length;\n\n\t\twhile (len--) {\n\t\t\tvar entry = this._data[len];\n\t\t\tvar value = entry[valueField];\n\t\t\tvar latlng = entry.latlng;\n\n\n\t\t\t// we don't wanna render points that are not even on the map ;-)\n\t\t\tif (!bounds.contains(latlng)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t// local max is the maximum within current bounds\n\t\t\tlocalMax = Math.max(value, localMax);\n\t\t\tlocalMin = Math.min(value, localMin);\n\n\t\t\tvar point = this._map.latLngToContainerPoint(latlng);\n\t\t\tvar latlngPoint = { x: Math.round(point.x), y: Math.round(point.y) };\n\t\t\tlatlngPoint[valueField] = value;\n\n\t\t\tvar radius;\n\n\t\t\tif (this.cfg.fixedRadius && this.cfg.radiusMeters) {\n\t\t\t\tradius = this._getPixelRadius();\n\t\t\t} else if (entry.radius) {\n\t\t\t\tradius = entry.radius * radiusMultiplier;\n\t\t\t} else {\n\t\t\t\tradius = (this.cfg.radius || 2) * radiusMultiplier;\n\t\t\t}\n\t\t\tlatlngPoint.radius = radius;\n\t\t\tlatLngPoints.push(latlngPoint);\n\t\t}\n\t\tif (this.cfg.useLocalExtrema) {\n\t\t\tgeneratedData.max = localMax;\n\t\t\tgeneratedData.min = localMin;\n\t\t}\n\n\t\tgeneratedData.data = latLngPoints;\n\t\tthis._heatmap.setData(generatedData);\n\t},\n\n\tsetData: function(options) {\n\n\t\tthis._max = options.max || this._max;\n\t\tthis._min = options.min || this._min;\n\t\tthis._maxFactor = this.cfg.heatBin && this.cfg.heatBin.maxFactor ? this.cfg.heatBin.maxFactor : 1;\n\t\tthis._latField = this.cfg.latField || 'lat';\n\t\tthis._lngField = this.cfg.lngField || 'lng';\n\t\tthis._valueField = this.cfg.valueField || 'value';\n\t\tconst self = this;\n\t\tvar data = options.data;\n\n\t\t// compute grid if we're binning\n\t\tif (data.length > 0 && this.cfg.heatBin && this.cfg.heatBin.enabled){\n\t\t\tthis._cellSizeKm = this.cfg.heatBin.cellSizeKm || 5;\n\t\t\tdata = this._computeHeatmapGrid(data);\n\t\t\tthis._max = data.map((d) => { return d.value; }).reduce(function(a, b) { return Math.max(a, b); }) * this._maxFactor;\n\t\t}\n\n\t\tvar len = data.length;\n\t\tvar d = [];\n\n\t\t// transform data to latlngs\n\t\twhile (len--) {\n\t\t\tvar entry = data[len];\n\t\t\tvar latlng = new L.LatLng(entry[self._latField], entry[self._lngField]);\n\t\t\tvar dataObj = { latlng: latlng };\n\t\t\tdataObj[self._valueField] = entry[self._valueField];\n\t\t\tif (entry.radius) {\n\t\t\t\tdataObj.radius = entry.radius;\n\t\t\t}\n\t\t\td.push(dataObj);\n\t\t}\n\n\t\tthis._data = d;\n\t\tthis._draw();\n\t},\n\n\t/*--------------------------------------------- PRIVATE ---------------------------------------------*/\n\n\t_draw: function() {\n\t\tif (!this._map) { return; }\n\n\t\tvar mapPane = this._map.getPanes().mapPane;\n\t\tvar point = mapPane._leaflet_pos;\n\n\t\t// reposition the layer\n\t\tthis._el.style[HeatBin.CSS_TRANSFORM] = 'translate(' +\n\t\t\t-Math.round(point.x) + 'px,' +\n\t\t\t-Math.round(point.y) + 'px)';\n\n\t\tthis.update();\n\t},\n\n\t_getPixelRadius: function () {\n\n\t\tvar centerLatLng = this._map.getCenter();\n\t\tvar pointC = this._map.latLngToContainerPoint(centerLatLng);\n\t\tvar pointX = [pointC.x + 1, pointC.y];\n\n\t\t// convert containerpoints to latlng's\n\t\tvar latLngC = this._map.containerPointToLatLng(pointC);\n\t\tvar latLngX = this._map.containerPointToLatLng(pointX);\n\n\t\t// Assuming distance only depends on latitude\n\t\tvar distanceX = latLngC.distanceTo(latLngX);\n\t\t// 100 meters is the fixed distance here\n\t\tvar pixels = this.cfg.radiusMeters / distanceX;\n\n\t\treturn pixels >= 1 ? pixels : 1;\n\t},\n\n\t_reset: function () {\n\t\tthis._origin = this._map.layerPointToLatLng(new L.Point(0, 0));\n\n\t\tvar size = this._map.getSize();\n\t\tif (this._width !== size.x || this._height !== size.y) {\n\t\t\tthis._width  = size.x;\n\t\t\tthis._height = size.y;\n\n\t\t\tthis._el.style.width = this._width + 'px';\n\t\t\tthis._el.style.height = this._height + 'px';\n\n\t\t\tthis._heatmap._renderer.setDimensions(this._width, this._height);\n\t\t}\n\t\tthis._draw();\n\t},\n\n\t_computeHeatmapGrid (data) {\n\n\t\t// CREATE BBOX\n\t\tconst bounds = this.getLatLngBounds(data);\n\t\tif (!bounds) return false;\n\n\t\t// minX, minY, maxX, maxY\n\t\tconst bbox = [\n\t\t\tbounds.getWest(),\n\t\t\tbounds.getNorth(),\n\t\t\tbounds.getEast(),\n\t\t\tbounds.getSouth()\n\t\t];\n\n\t\tconst bottomLeft = [bounds.getWest(), bounds.getSouth()];\n\t\tconst bottomRight = [bounds.getEast(), bounds.getSouth()];\n\t\tconst topLeft = [bounds.getWest(), bounds.getNorth()];\n\n\t\t// CREATE A GRID OF CELLS\n\t\t// GRID origin is bottomRight\n\t\t// the indexes increment by:\n\t\t// xCol=0, yRow upwards, then xCol=1 etc.\n\t\tconst lengthKm = this._cellSizeKm;\n\t\tconst grid = turf.squareGrid(bbox, lengthKm, { units: 'kilometers' });\n\n\t\tgrid.features.reverse();\n\t\tgrid.features.forEach((f, index) => { f.properties['index'] = index; });\n\t\tconsole.log(grid);\n\n\t\t// DEBUG - plot the binning grid on map\n\t\tif (this.cfg.heatBin && this.cfg.heatBin.showBinGrid) {\n\t\t\tL.geoJSON(grid, {\n\t\t\t\tstyle: function (feature) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tweight: 1,\n\t\t\t\t\t\tfill: false\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonEachFeature: function (feature, layer) {\n\t\t\t\t\tlayer.bindTooltip(`cell index: ${feature.properties.index}`);\n\t\t\t\t}\n\t\t\t}).addTo(this._map);\n\t\t}\n\n\t\t// calc XY lengths\n\t\tconst xGridLength = turf.distance(turf.point(bottomLeft), turf.point(bottomRight), { units: 'kilometers' });\n\t\tconst yGridLength = turf.distance(turf.point(bottomLeft), turf.point(topLeft), { units: 'kilometers' });\n\t\tconsole.log(`xGridLenth: ${xGridLength}, yGridLenth: ${yGridLength}`);\n\n\t\t// calc XY cell length of grid\n\t\tconst xCellLength = Math.floor(xGridLength / lengthKm);\n\t\tconst yCellLength = Math.floor(yGridLength / lengthKm);\n\t\tconst totalCells = xCellLength * yCellLength;\n\t\tconsole.log(`xCellLenth: ${xCellLength}, yCellLenth: ${yCellLength}`);\n\t\tconsole.log(`total cells: ${totalCells}`);\n\n\t\t// PUT EACH POINT INTO A CELL\n\t\tconst points = data.map((d) => { return {\n\t\t\tlat: d[this._latField],\n\t\t\tlng: d[this._lngField]\n\t\t}; });\n\n\t\t// for each point get its offset from minX and minY\n\t\tpoints.forEach((p) => {\n\n\t\t\t// point dist from left\n\t\t\tconst xDist = turf.distance(\n\t\t\t\tturf.point([p.lng, p.lat]),\n\t\t\t\tturf.point([bounds.getEast(), p.lat]),\n\t\t\t\t{ units: 'kilometers' }\n\t\t\t);\n\t\t\t// point dist from bottom\n\t\t\tconst yDist = turf.distance(\n\t\t\t\tturf.point([p.lng, p.lat]),\n\t\t\t\tturf.point([p.lng, bounds.getSouth()]),\n\t\t\t\t{ units: 'kilometers' }\n\t\t\t);\n\n\t\t\t// find the XY cell indices\n\t\t\tlet xCell = Math.round(xDist / lengthKm);\n\t\t\tlet yCell = Math.round(yDist / lengthKm);\n\n\t\t\t// translate 2D index into 1D index\n\t\t\tlet i = (xCell * yCellLength) + yCell;\n\t\t\tif (i >= totalCells) i = totalCells - 1;\n\n\t\t\tif (grid.features[i].properties.count) {\n\t\t\t\tgrid.features[i].properties.count++\n\t\t\t} else {\n\t\t\t\tgrid.features[i].properties['count'] = 1;\n\t\t\t}\n\n\t\t});\n\n\t\tlet valid = 0;\n\t\tgrid.features.forEach((f) => { if (f.properties.count > 0) valid++; });\n\n\t\t// USE EACH CELL AS A HEATMAP DATA POINT\n\t\tlet heatmapCells = [];\n\t\tgrid.features.forEach((f) => {\n\t\t\tif (f.properties.count) {\n\t\t\t\tlet centroid = turf.centroid(f);\n\t\t\t\theatmapCells.push({\n\t\t\t\t\tlat:   centroid.geometry.coordinates[1],\n\t\t\t\t\tlng:   centroid.geometry.coordinates[0],\n\t\t\t\t\tvalue: f.properties.count\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn heatmapCells;\n\t}\n});\n\nHeatBin.CSS_TRANSFORM = (function() {\n\tvar div = document.createElement('div');\n\tvar props = [\n\t\t'transform',\n\t\t'WebkitTransform',\n\t\t'MozTransform',\n\t\t'OTransform',\n\t\t'msTransform'\n\t];\n\n\tfor (var i = 0; i < props.length; i++) {\n\t\tvar prop = props[i];\n\t\tif (div.style[prop] !== undefined) {\n\t\t\treturn prop;\n\t\t}\n\t}\n\treturn props[0];\n})();\n\nL.heatBin = function (options) {\n\treturn new HeatBin(options);\n};\n\nexport default L.heatBin;\n\n"],"names":["this","HeatBin","L","Layer","Class","extend","initialize","config","cfg","_el","DomUtil","create","_data","_max","_min","container","onAdd","map","size","getSize","_map","_width","x","_height","y","style","width","height","position","_origin","layerPointToLatLng","Point","getPanes","overlayPane","appendChild","_heatmap","h337","on","_reset","_draw","addTo","addLayer","onRemove","removeChild","off","getLatLngBounds","data","length","latLngBounds","d","_latField","_lngField","update","bounds","zoom","scale","generatedData","max","min","getBounds","getZoom","Math","pow","setData","latLngPoints","radiusMultiplier","scaleRadius","localMax","localMin","valueField","len","entry","value","latlng","contains","point","latLngToContainerPoint","latlngPoint","round","radius","fixedRadius","radiusMeters","_getPixelRadius","push","useLocalExtrema","options","_maxFactor","heatBin","maxFactor","latField","lngField","_valueField","self","enabled","_cellSizeKm","cellSizeKm","_computeHeatmapGrid","reduce","a","b","LatLng","dataObj","mapPane","_leaflet_pos","CSS_TRANSFORM","centerLatLng","getCenter","pointC","pointX","latLngC","containerPointToLatLng","latLngX","distanceX","distanceTo","pixels","_renderer","setDimensions","bbox","getWest","getNorth","getEast","getSouth","bottomLeft","bottomRight","topLeft","lengthKm","grid","turf","squareGrid","units","features","reverse","forEach","f","index","properties","console","log","showBinGrid","geoJSON","feature","weight","fill","onEachFeature","layer","bindTooltip","xGridLength","distance","yGridLength","xCellLength","floor","yCellLength","totalCells","points","lat","lng","p","xDist","yDist","xCell","yCell","i","count","valid","heatmapCells","centroid","geometry","coordinates","div","document","createElement","props","prop","undefined"],"mappings":"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"}